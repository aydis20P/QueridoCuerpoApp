{% extends 'queridocuerpo_app/base.html' %}
{% load static %}

{% block head %}
<link rel="stylesheet" href="{% static 'css/styles.css' %}"> 
<title>Calendario de citas</title>
{% endblock head %}

{% block header %}

     {% include 'queridocuerpo_app/navbar.html' %}
      
{% endblock header %}


{% block content %}


<!-- Tabs navs -->
<ul class="nav nav-tabs mb-3" id="ex1" role="tablist">
    <li class="nav-item" role="presentation" onclick="tabToInput()">
    <a
        class="nav-link active"
        id="ex1-tab-1"
        data-mdb-toggle="tab"
        href="#ex1-tabs-1"
        role="tab"
        aria-controls="ex1-tabs-1"
        aria-selected="true"
        >Psicológica</a
    >
    </li>
    <li class="nav-item" role="presentation" onclick="tabToInput()">
    <a
        class="nav-link"
        id="ex1-tab-2"
        data-mdb-toggle="tab"
        href="#ex1-tabs-2"
        role="tab"
        aria-controls="ex1-tabs-2"
        aria-selected="false"
        >Nuticición</a
    >
    </li>
    <li class="nav-item" role="presentation" onclick="tabToInput()">
    <a
        class="nav-link"
        id="ex1-tab-3"
        data-mdb-toggle="tab"
        href="#ex1-tabs-3"
        role="tab"
        aria-controls="ex1-tabs-3"
        aria-selected="false"
        >Entrenamiento</a
    >
    </li>
</ul>
<!-- Tabs navs -->


<!-- Tabs content -->
<div class="tab-content" id="ex1-content">

    <!-- Tab 1 -->
    <div
    class="tab-pane fade show active"
    id="ex1-tabs-1"
    role="tabpanel"
    aria-labelledby="ex1-tab-1"
    value = "psicológica"
    >

        <h5 class="ms-3"> Cita Psicológica </h5>

    </div>

    <!-- Tab 2 -->
    <div class="tab-pane fade" id="ex1-tabs-2" role="tabpanel" aria-labelledby="ex1-tab-2">
        
        <h5 class="ms-3"> Cita Nutrición </h5>

    </div>

    <!-- Tab 3 -->
    <div class="tab-pane fade" id="ex1-tabs-3" role="tabpanel" aria-labelledby="ex1-tab-3">
        
        <h5 class="ms-3"> Entrenamiento </h5>

    </div>

</div>
<!-- Tabs content -->

<input id="tipo-cita" name="tipo-cita" type="hidden" value="ex1-tab-1">

<div class="container mt-3">
    <div id="card-mes" class="row">
        <div class="col">
            <div class="card text-white bg-info">
                <div class="card-header">
                    <h5>Mes:</h5>
                </div>
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div></div>
                        <div>
                            <select id="select-mes" class="form-select mb-3 mt-3">
                                <option value="0" selected>Selecciona un mes</option>
                                <option value="1">Enero</option>
                                <option value="2">Febrero</option>
                                <option value="3">Marzo</option>
                                <option value="4">Abril</option>
                                <option value="5">Mayo</option>
                                <option value="6">Junio</option>
                                <option value="7">Julio</option>
                                <option value="8">Agosto</option>
                                <option value="9">Septiembre</option>
                                <option value="10">Octubre</option>
                                <option value="11">Noviembre</option>
                                <option value="12">Diciembre</option>
                            </select>
                            <h5 id="text-mes" style="display: none;">test</h5>
                        </div>
                        <div></div>
                    </div>
                    <div class="col d-flex justify-content-center" onclick="showCardDia('card-dia')" style="cursor: pointer;">
                        <p id="sig-mes" class="lead mb-1">
                            <small>
                                Siguiente
                            </small>
                        </p>
                        <i id="sig-mes-icon" class="fas fa-arrow-down p-2"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="card-dia" class="row mt-3" style="display: none;">
        <div class="col">
            <div class="card text-white bg-info">
                <div class="card-header">
                    <h5>Día:</h5>
                </div>
                <div class="card-body">
                    <div class="d-flex justify-content-center">
                        <div></div>
                        <div>
                            <select id="select-dia" class="form-select mb-3 mt-3">
                                <option value="0" selected>Selecciona un día</option>
                                {% for month in months %}
                                    {% for i in month.2 %}
                                        {% comment %}
                                        <option name="{{ month.3 }}" value="{{ i }}" style="display: none;">{{ i }}</option>
                                        {% endcomment %}
                                    {% endfor %}
                                {% endfor %}
                            </select>
                            <h5 id="text-dia" style="display: none;">test</h5>
                        </div>
                        <div></div>
                    </div>
                    <div id="botones-dia" class="col d-flex justify-content-between">
                        <div class="d-flex justify-content-end" onclick="regresaCardMes('card-dia')" style="cursor: pointer;">
                            <p class="lead mb-1">
                                <small>
                                    Anterior
                                </small>
                            </p>
                            <i class="fas fa-arrow-up p-2"></i>
                        </div> 
                        <div class="d-flex justify-content-end" onclick="showCardHorario('btn-consultar')" style="cursor: pointer;">
                            <p class="lead mb-1">
                                <small>
                                    Siguiente
                                </small>
                            </p>
                            <i class="fas fa-arrow-down p-2"></i>
                        </div> 
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div id="btn-consultar" class="row mt-3 mb-3" style="display: none;">
        <div class="col">
            <div class="row">
                <div class="col d-grid">
                    <a class="btn btn-outline-light" data-mdb-ripple-color="dark" onclick="regresaCardDia('btn-consultar')">
                        Editar <i class="fas fa-edit icon-success"></i>
                    </a>
                </div>
                <div class="col d-grid">
                    <a href="citas-disponibles" class="btn btn-outline-light" data-mdb-ripple-color="dark">
                        Consultar <i class="fas fa-search icon-success"></i>
                    </a>  
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock content %}

{% block script %}
<script>

    function tabToInput() {
        var tabs = document.querySelectorAll('[role="tab"]')
        for(i = 0; i<tabs.length; i++){
            if(tabs[i].classList.contains("active")){
                document.getElementById("tipo-cita").value = tabs[i].id
            }
        }
    }

    /**
     * función para mostrar tarjeta día, mandar números de días
     * segun el mes y ocultar la opción siguiente y el select de la tarjeta mes.
     * input: id de la tarjeta día.
     * */
    function showCardDia(id) {
        //mostrar tarjeta día
        var x = document.getElementById(id);
        x.style.display = "block";
        //pasar el valor de select mes a text mes
        var y = document.getElementById("select-mes");
        var i = y.selectedIndex;
        document.getElementById("text-mes").innerHTML = y.options[i].textContent;
        document.getElementById("text-mes").style.display = "block";
        //ocultar select mes y boton siguiente
        y.style.display = "none";
        document.getElementById("sig-mes").style.display = "none";
        document.getElementById("sig-mes-icon").style.display = "none";

        //agregar días al select día según el mes, tomando días del range en context
        var selectDia = document.getElementById("select-dia");
        //obtener el mes seleccionado del select mes
        var m = y.options[i].value;
        //para cada mes en el contexto 
        {% for month in months %}
            //si es el més seleccionado en el select mes
            if ({{ month.3 }} == m){
                //agregar los días correspondientes al select
                {% for i in month.2 %}
                    var option = document.createElement("option");
                    option.text = "{{ i }}";
                    selectDia.add(option, selectDia[{{ i }}]);
                {% endfor %}
            }
        {% endfor %}
    }

    function regresaCardMes(id) {
        document.getElementById(id).style.display = "none";
        document.getElementById("card-mes").style.display = "block";
        document.getElementById("select-mes").style.display = "block";
        document.getElementById("text-mes").style.display = "none";
        document.getElementById("sig-mes").style.display = "block";
        document.getElementById("sig-mes-icon").style.display = "block";

        var selectDia = document.getElementById("select-dia");
        for (i = selectDia.options.length-1; i >= 0; i--) {
            selectDia.options[i] = null;
        }
    }

    function showCardHorario(id) {
        var x = document.getElementById(id);
        x.style.display = "block";
        var y = document.getElementById("select-dia");
        var i = y.selectedIndex;
        document.getElementById("text-dia").innerHTML = y.options[i].value;
        document.getElementById("text-dia").style.display = "block";
        y.style.display = "none";
        document.getElementById("botones-dia").style.display = "none";
        document.getElementById("botones-dia").classList.remove("d-flex");
    }

    function regresaCardDia(id) {
        document.getElementById(id).style.display = "none";
        document.getElementById("card-dia").style.display = "block";
        document.getElementById("select-dia").style.display = "block";
        document.getElementById("text-dia").style.display = "none";
        document.getElementById("botones-dia").classList.add("d-flex");
        document.getElementById("botones-dia").style.display = "block";
    }

</script>
{% endblock script %}
